form.addEventListener("submit",function(e){e.preventDefault(),clearAllErrors();let t=!0;if(Object.keys(validationRules).forEach(e=>{validateField(document.getElementById(e))||(t=!1)}),t){buttonText.classList.add("hidden"),buttonSpinner.classList.remove("hidden"),submitButton.disabled=!0;const e="save-contact.php",t=new FormData(form);t.set("phone",iti.getNumber()),fetch(e,{method:"POST",body:t}).then(e=>e.json()).then(e=>{console.log("Server Response:",e),e.success?(form.classList.add("hidden"),successMessage.classList.remove("hidden"),setTimeout(()=>closeForm(),3e3)):alert("Submission failed: "+e.message)}).catch(e=>{console.error("Error!",e),alert("There was a network error submitting the form. Please try again.")}).finally(()=>{buttonText.classList.remove("hidden"),buttonSpinner.classList.add("hidden"),submitButton.disabled=!1})}});