document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("whatsapp-form"),t=document.getElementById("wa-phone"),a=document.getElementById("wa-toggle"),n=document.getElementById("close-wa-form"),s=document.getElementById("wa-form-container"),d=document.getElementById("wa-form-card"),o=window.intlTelInput(t,{initialCountry:"auto",preferredCountries:["us","in","gb"],geoIpLookup:function(e){fetch("https://ipapi.co/json").then(e=>e.json()).then(t=>e(t.country_code)).catch(()=>e("us"))},utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.13/js/utils.js"}),i={"wa-name":{validate:e=>/^[a-zA-Z\s'-]{2,50}$/.test(e),message:"Please enter a valid name (at least 2 characters)."},"wa-email":{validate:e=>/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i.test(e),message:"Please enter a valid email address."},"wa-phone":{validate:()=>o.isValidNumber(),message:"Please enter a valid phone number."},"wa-message":{validate:e=>e.length>=10&&e.length<=300,message:"Message must be 10-300 characters."}},r=e=>{const t=document.getElementById(e),a=i[e],n="wa-phone"===e?a.validate():a.validate(t.value.trim());return n?l(e):c(e,a.message),n},c=(e,t)=>{const a=document.getElementById(e),n=document.getElementById(`${e}-error`),s="wa-phone"===e?a.parentElement:a;s.classList.add("border-red-500","focus-within:border-red-500"),s.classList.remove("border-gray-300"),n.textContent=t,n.classList.remove("hidden")},l=e=>{const t=document.getElementById(e),a=document.getElementById(`${e}-error`),n="wa-phone"===e?t.parentElement:t;n.classList.remove("border-red-500","focus-within:border-red-500"),n.classList.add("border-gray-300"),a.textContent="",a.classList.add("hidden")},m=()=>{Object.keys(i).forEach(l)};["wa-name","wa-email","wa-phone"].forEach(e=>{const a=document.getElementById(e);("wa-phone"===e?t.parentElement:a).addEventListener("blur",()=>r(e))}),document.getElementById("wa-message").addEventListener("input",()=>r("wa-message")),e.addEventListener("submit",function(t){t.preventDefault();if(Object.keys(i).reduce((e,t)=>r(t)&&e,!0)){const t=document.getElementById("wa-name").value.trim(),a=document.getElementById("wa-email").value.trim(),n=o.getNumber(),s=document.getElementById("wa-message").value.trim(),d=`https://wa.me/${"918888591205"}?text=${encodeURIComponent(`Hi, my name is ${t}.\nMy email is ${a}.\nMy phone number is ${n}.\n\nMessage:\n${s}`)}`;window.open(d,"_blank"),u(),e.reset(),m(),o.setCountry("auto")}});const u=()=>{s.classList.add("opacity-0"),s.classList.remove("opacity-100"),d.classList.add("scale-95"),d.classList.remove("scale-100"),setTimeout(()=>{s.classList.add("pointer-events-none"),m()},300)};a.addEventListener("click",()=>{s.classList.remove("pointer-events-none"),s.classList.add("opacity-100"),s.classList.remove("opacity-0"),d.classList.add("scale-100"),d.classList.remove("scale-95")}),n.addEventListener("click",u),s.addEventListener("click",e=>{e.target===s&&u()})});